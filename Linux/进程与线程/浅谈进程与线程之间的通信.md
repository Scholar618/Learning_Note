# 浅谈进程与线程之间的通信

## 1.1 为什么进程与线程之间要有通信？

### 1.1.1 复习进程与线程的概念

#### 进程

进程是系统分配资源的基本单位，被视为一个独立的执行单元。例如使用gcc编译后用**./文件名**进行执行即为进程运行

#### 线程

线程是**进程内**的执行单元，一个进程可以包括多个线程，它们共享进程的资源，如地址空间、文件描述符等。例如.c文件里创建线程。

### 1.1.2 进程与线程要有通信的原因

- 共享数据：进程和线程之间可以共享内存区域，这可以使多个线程之间共享进程数据，从而提高处理数据的效率。
- 协调任务：在某些情况，进程需要将任务分配给多个线程完成，那么线程之间要相互协调完成任务。这时，进程就起到了小组长的作用，协调多个线程完成任务。
- 通知状态：进程有时要通知另外一个进程或线程，某些事件是否发生，这时通过信号和管道等机制来通知彼此的状态。
- 安全性：进程和线程之间可以通过共享锁来保护共享资源的访问，从而避免竞争条件和资源争用问题。

## 1.2进 程与线程之间的通信

在上面进程与线程要有通信的原因里我们提到了信号，管道这些名词，那么我们就从这些开始了解进程与线程之间的通信吧。

### 1.2.1 信号

#### 信号介绍

Linux信号类似于人之间传递的信号。

人之间传递的信号有很多种，比如我饿了、我想你了、我先睡了等等。但是传递这些信号，另外一个人就要停下手头的事去帮传递信号人的忙（假定不会拒绝，拒绝也是停下手头的事去拒绝）

计算机里的信号也类似，当收到一个信号后，会中断当前的程序去执行信号

### 1.2.2 使用信号进行通信

一个进程可以向另一个进程发送信号，以通知某件事件已经发生或某种状态已经发生改变；也可以捕获另一个进程的信号，并执行相应操作

> 例如：父进程向子进程发送SIGTERM信号，以通知子进程停止运行
>
> 一个进程可以向另一个进程发送自定义信号，以通知它某个共享资源的状态发生了变化，从而促使另一个进程更新它的状态。
>
> 一个进程可以捕获另一个进程发送的 SIGUSR1 信号，并在接收到信号时执行某个自定义操作，如打印日志或记录某个事件。

在上述实例中，将进程换成线程同样可行。

但需要注意，信号是异步的，会打断程序的正常执行，尽量使信号简洁快速。

